 {
  "name": "angular-library-local",
  "description": "Template for Angular libraries with local tarball deployment",
  "variables": {
    "projectIdentifier": "\"name\": \"@{{scope}}/{{projectIdentifier}}\"",
    "version": "\"version\": \"{{version}}\""
  },
  "detect": {
    "manifest": "package.json",
    "searchPattern": "\"@{{scope}}/{{identifier}}\""
  },
  "steps": [
    {
      "name": "Update library version",
      "cmd": "npm version {{newVersion}} --no-git-tag-version",
      "workdir": "{{sourceDir}}"
    },
    {
      "name": "Build Angular library",
      "cmd": "ng build @{{scope}}/{{identifier}}",
      "workdir": "{{sourceDir}}"
    },
    {
      "name": "Pack library to tarball",
      "type": "script",
      "script": [
        "cd {{sourceDir}}/dist/{{scope}}/{{identifier}}",
        "npm pack"
      ],
      "workdir": "{{sourceDir}}"
    },
    {
      "name": "Install tarball in consumer project",
      "cmd": "npm install {{sourceDir}}/dist/{{scope}}/{{identifier}}/{{scope}}-{{identifier}}-{{newVersion}}.tgz",
      "workdir": "{{targetDir}}"
    },
    {
      "name": "Install all dependencies",
      "cmd": "npm install",
      "workdir": "{{targetDir}}"
    }
  ]
}
